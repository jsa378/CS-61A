
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta name="description" content ="CS 61A: Structure and Interpretation of Computer Programs" />
    <meta name="keywords" content ="Computer Science, Programming, Berkeley, EECS" />
    <meta name="author" content ="John DeNero, Jedi Tsang (Guest Lecturer), Shm Almeda (GSI)" />
    <!-- CHANGED CAREFUL -->
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta name="viewport" content="width=device-width">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-throttle-debounce/1.1/jquery.ba-throttle-debounce.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="/assets/js/hl.js"></script>
    <script src="/assets/js/toggledarkmode.js"></script>
    <script>
        // we aren't registering builtins since
        //      (1) they don't render differently in the current CSS from other names
        //      (2) it's a mess to list all of them. You can extract from the site but that takes effort
        // if (1) ceases to be true, (2) might be worth the effort. For now, we're leaving as is
        hljsRegister({
            'keyword': "define if cond and or let begin lambda mu quote delay cons-stream set! quasiquote unquote unquote-splicing define-macro"
        });
        hljs.initHighlightingOnLoad();
    </script>
    <script src="/assets/js/dark-mode.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inconsolata|Roboto:300,400,500|Work+Sans:400,700">
    <link rel="stylesheet" href="/assets/css/style.css">
    <link rel="stylesheet" href="/assets/css/mono-blue.css">
    <link rel="icon" href="/assets/images/favicon.ico">

    

<link rel="stylesheet" type="text/css" href="/assets/css/disc.css">


    <title>
Discussion 5 | CS 61A Fall 2024
</title>
  </head>

  <body id="index" class="home">
    <nav class="navbar navbar-default navbar-static-top">
      <div class="container noselect">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse-section" aria-label="Toggle Navigation Bar">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/">
            CS 61A
            <!-- <img style="max-width:60px; margin-top: -20px;" class="logo" src="/assets/images/logo.png"/> -->
          </a>
        </div>

        <div class="collapse navbar-collapse" id="navbar-collapse-section">
          <ul class="nav navbar-nav navbar-right">

            
            <li><a href="/">Lectures</a></li>
            
            <li><a href="/articles/about-61a/">Syllabus</a></li>
            
            <li><a href="https://edstem.org/us/courses/63971/discussion/">Ed</a></li>
            
            <li><a href="/office-hours/">Office Hours</a></li>
            
            <li><a href="/articles/contact-61a/">Contact</a></li>
            

            
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Links
                <span class="caret"></span>
              </a>
              <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                
                <li><a href="https://go.cs61a.org/61a-extensions">Request an Extension</a></li>
                
                <li><a href="https://go.cs61a.org/61a-regrades">Request a Regrade</a></li>
                
                <li><a href="https://oh.cs61a.org/">Office Hours Queue</a></li>
                
                <li><a href="https://www.gradescope.com/courses/843175">Gradescope</a></li>
                
                <li><a href="https://bcourses.berkeley.edu/courses/1538118/pages">Lecture Recordings</a></li>
                
                <li><a href="https://pythontutor.com/cp/composingprograms.html">Python Tutor</a></li>
                
                <li><a href="https://code.cs61a.org/scheme/">Scheme Editor</a></li>
                
              </ul>
            </li>
            
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Resources
                <span class="caret"></span>
              </a>
              <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                
                <li><a href="/resources/">Past Exams & Websites</a></li>
                
                <li><a href="https://www.composingprograms.com">Textbook</a></li>
                
                <li><a href="https://drive.google.com/file/d/1O72u0ml65pibcjz-PXKpqeJDKaVqQ3D8/view">Debugging Guide</a></li>
                
                <li><a href="/articles/studying/">Studying Guide</a></li>
                
                <li><a href="/articles/composition/">Composition Guide</a></li>
                
                <li><a href="/articles/campus-res/">Campus Resources</a></li>
                
                <li><a href="/articles/advice/">Advice from Students</a></li>
                
              </ul>
            </li>
            
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Staff
                <span class="caret"></span>
              </a>
              <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                
                <li><a href="/instructor">Instructors</a></li>
                
                <li><a href="/staff">TAs & Tutors</a></li>
                
                <li><a href="/academic-interns">Academic Interns</a></li>
                
              </ul>
            </li>
            

          </ul>
        </div>
      </div>
    </nav>

    <main id="content" class="container">
      
<div class='row'>
  <div class='col-md-9'>
    <header>
      <h1>
        
Discussion 5: Trees

        
        
        <ul class="inline-block list-inline">
          <li><a href="disc05.pdf" class="label label-outline">disc05.pdf</a></li>
        </ul>
        
        
      </h1>
    </header>
    

<!-- <div class="alert storable-login-status"></div> -->


    
<p>Switch to Pensieve:</p>

<ul>
  <li><strong>Everyone</strong>: Go to <a href="https://tutor.pensieve.co/schools/berkeley/all/cs61a/cs61a_fa24/65d4ec6600b2c0fafe1be10f/open">pensieve.co</a>, log in with your @berkeley.edu email, and <strong>enter your group number</strong> (which was in the email that assigned you to this lab).</li>
</ul>

<p>Once you're on Pensieve, you don't need to return to this page; Pensieve has all the same content (but more features). If for some reason Penseive doesn't work, return to this page and continue with the discussion.</p>


<h1 id="getting-started">Getting Started</h1>


<p>Everyone go around and say your name.</p>

<p><strong>For fun:</strong> Think of a big word with at least three syllables, such as
"solitary" or "conundrum" or "ominous". Try to use it as many times as you can
during today's discussion, but in ways that don't give away that it's your big
word. At the end, your group will try to guess each person's big word. Whoever
uses their big word the most times (and at least twice) without their group
guessing it wins.  (You win nothing; it's just a game.)</p>

<p><strong>To get help from a TA</strong>, If you do not have an in-person TA, you can reach your TA using this <a href="https://berkeley.zoom.us/j/91340395124?pwd=7Lqljf1tslL0QlufLz6HrBtSCB8Ojv.1">Zoom link</a>.</p>

<p>If there are fewer than 3 people in your group, feel free to merge your group with another group in the room.</p>


<h1 id="trees">Trees</h1>


<p>For a tree <code>t</code>:</p>

<ul>
  <li>Its root label can be any value, and <code>label(t)</code> returns it.</li>
  <li>Its branches are trees, and <code>branches(t)</code> returns a list of branches.</li>
  <li>An identical tree can be constructed with <code>tree(label(t), branches(t))</code>.</li>
  <li>You can call functions that take trees as arguments, such as <code>is_leaf(t)</code>.</li>
  <li>That's how you work with trees. No <code>t == x</code> or <code>t[0]</code> or <code>x in t</code> or <code>list(t)</code>, etc.</li>
  <li>There's no way to change a tree (that doesn't violate an abstraction barrier).</li>
</ul>

<p>Here's an example tree <code>t1</code>, for which its branch <code>branches(t1)[1]</code> is <code>t2</code>.</p>

<pre><code class="python">t2 = tree(5, [tree(6), tree(7)])
t1 = tree(3, [tree(4), t2])</code></pre>



<p><img class="img-responsive center-block" src="assets/example_tree_illustration.png" alt="Example Tree" width="100%" height=""></p>

<p>A path is a sequence of trees in which each is the parent of the next.</p>


        <button id='toggle-1' class='btn btn-outline btn-lg alwaystoggle toggle'>
        Tree Implementation<noscript> (enable JavaScript)</noscript>
        </button>
        <div class="solution toggle-1">

<p>You don't need to know how <code>tree</code>, <code>label</code>, and <code>branches</code> are implemented in
order to use them correctly, but here is the implementation from lecture.</p>

<pre><code class="python">def tree(label, branches=[]):
    for branch in branches:
        assert is_tree(branch), &#x27;branches must be trees&#x27;
    return [label] + list(branches)

def label(tree):
    return tree[0]

def branches(tree):
    return tree[1:]

def is_leaf(tree):
    return not branches(tree)

def is_tree(tree):
    if type(tree) != list or len(tree) &lt; 1:
        return False
    for branch in branches(tree):
        if not is_tree(branch):
            return False
    return True</code></pre>


</div>


<h3 id="q1-warm-up">Q1: Warm Up</h3>


<p>What value is bound to <code>result</code>?</p>

<pre><code>result = label(min(branches(max([t1, t2], key=label)), key=label))</code></pre>





<p>How convoluted! (That's a big word.)</p>


        <button id='toggle-2' class='btn btn-outline btn-lg alwaystoggle toggle'>
        What does key do?<noscript> (enable JavaScript)</noscript>
        </button>
        <div class="solution toggle-2">

<p>Here's a quick refresher on how <code>key</code> functions work with <code>max</code> and <code>min</code>,</p>

<p><code>max(s, key=f)</code> returns the item <code>x</code> in <code>s</code> for which <code>f(x)</code> is largest.</p>

<pre><code class="python">&gt;&gt;&gt; s = [&#x2d;3, &#x2d;5, &#x2d;4, &#x2d;1, &#x2d;2]
&gt;&gt;&gt; max(s)
&#x2d;1
&gt;&gt;&gt; max(s, key=abs)
&#x2d;5
&gt;&gt;&gt; max([abs(x) for x in s])
5</code></pre>



<p>Therefore, <code>max([t1, t2], key=label)</code> returns the tree with the largest label,
in this case <code>t2</code>.
</div></p>

<p>In case you're wondering, this expression does not violate an abstraction
barrier. <code>[t1, t2]</code> and <code>branches(t)</code> are both lists (not trees), and so it's
fine to call <code>min</code> and <code>max</code> on them.</p>

<div class="page-break"></div>


<h3 id="q2-has-path">Q2: Has Path</h3>


<p>Implement <code>has_path</code>, which takes a tree <code>t</code> and a list <code>p</code>. It returns whether
there is a path from the root of <code>t</code> with labels <code>p</code>. For example, <code>t1</code> has a
path from its root with labels <code>[3, 5, 6]</code> but not <code>[3, 4, 6]</code> or <code>[5, 6]</code>.</p>

<p><strong>Important</strong>: Before trying to implement this function, discuss these questions
from lecture about the recursive call of a tree processing function:</p>

<ul>
  <li>What recursive calls will you make?</li>
  <li>What type of values do they return?</li>
  <li>What do the possible return values mean?</li>
  <li>How can you use those return values to complete your implementation?</li>
</ul>

<p>If you get stuck, you can view our answers to these questions by clicking the
hint button below, but <em>please</em> don't do that until your whole group agrees.</p>


        <button id='toggle-3' class='btn btn-outline btn-lg alwaystoggle toggle'>
        Hint: Describing the Recursive Call<noscript> (enable JavaScript)</noscript>
        </button>
        <div class="solution toggle-3">
<strong>What recursive calls will you make?</strong>

<p>As you usual, you will call <code>has_path</code> on each branch <code>b</code>. You'll make this
call after comparing <code>p[0]</code> to <code>label(t)</code>, and so the second argument to
<code>has_path</code> will be the rest of <code>p</code>: <code>has_path(b, p[1:])</code>.</p>

<p><strong>What type of values do they return?</strong></p>

<p><code>has_path</code> always returns a <code>bool</code> value: <code>True</code> or <code>False</code>.</p>

<p><strong>What do the possible return values mean?</strong></p>

<p>If <code>has_path(b, p[1:])</code> returns <code>True</code>, then there is a path through branch <code>b</code>
for which <code>p[1:]</code> are the node labels.</p>

<p><strong>How can you use those return values to complete your implementation?</strong></p>

<p>If you have already checked that <code>label(t)</code> is equal to <code>p[0]</code>, then a <code>True</code>
return value means there is a path through <code>t</code> with labels <code>p</code> using that branch
<code>b</code>.  A <code>False</code> value means there is no path through that branch, but there
might be path through a different branch.
</div></p>


            <div class="monaco-storable" id="has_path-input" style="height:540px;"></div>
            <a href="javascript:void" id="modal-link-has_path-input">Run in 61A Code</a>
            <div class="modal fade" id="modal-has_path-input" tabindex="-1" role="dialog">
                <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content" style="padding-bottom: -5px">
                    <iframe
                        id="code-iframe-has_path-input"
                        width="100%"
                        height="700px"
                        style="border: none; display:block;"
                    ></iframe>
                    </div>
                </div>
            </div>
            <div class="storable-status"></div>
            <script>
                $(() => activateEditor('def has_path(t, p):\n    &quot;&quot;&quot;Return whether tree t has a path from the root with labels p.\n\n    &gt;&gt;&gt; t2 = tree(5, [tree(6), tree(7)])\n    &gt;&gt;&gt; t1 = tree(3, [tree(4), t2])\n    &gt;&gt;&gt; has_path(t1, [5, 6])        # This path is not from the root of t1\n    False\n    &gt;&gt;&gt; has_path(t2, [5, 6])        # This path is from the root of t2\n    True\n    &gt;&gt;&gt; has_path(t1, [3, 5])        # This path does not go to a leaf, but that&#x27;s ok\n    True\n    &gt;&gt;&gt; has_path(t1, [3, 5, 6])     # This path goes to a leaf\n    True\n    &gt;&gt;&gt; has_path(t1, [3, 4, 5, 6])  # There is no path with these labels\n    False\n    &quot;&quot;&quot;\n    if p == ____:  # when len(p) is 1\n        return True\n    elif label(t) != ____:\n        return False\n    else:\n        "*** YOUR CODE HERE ***"\n\n', "python", "has_path-input"));
            </script>
        



<p>If your group needs some guidance, you can click on the hints below, but please
talk with your group first before reading the hints.</p>


        <button id='toggle-4' class='btn btn-outline btn-lg alwaystoggle toggle'>
        Hint: Base Cases<noscript> (enable JavaScript)</noscript>
        </button>
        <div class="solution toggle-4">
The first base case should check whether <code>p</code> is a list of length one with the
label of <code>t</code> as its only element.  The second base case should check if the
first element of <code>p</code> matches the label of <code>t</code>.
</div>


        <button id='toggle-5' class='btn btn-outline btn-lg alwaystoggle toggle'>
        Hint: Recursive Case<noscript> (enable JavaScript)</noscript>
        </button>
        <div class="solution toggle-5">
When entering the recursive case, your code should already have checked that
<code>p[0]</code> is equal to <code>label(t)</code>, and so all that's left to check is that <code>p[1:]</code>
contains the labels in a path through one of the branches. One way is with
this template:

<pre><code>for ____:
    if ____:
        return True
return False</code></pre>


</div>

<div class="page-break"></div>

<p><strong>New Rule:</strong> Whoever in your group helped type the answer to the last question should not type the answer to the next one. Instead, just ask questions and give suggestions; give other members of your group a chance to type the answer.</p>


<h3 id="q3-find-path">Q3: Find Path</h3>


<p>Implement <code>find_path</code>, which takes a tree <code>t</code> with unique labels and a value
<code>x</code>. It returns a list containing the labels of the nodes along a path from the
root of <code>t</code> to a node labeled <code>x</code>.</p>

<p>If <code>x</code> is not a label in <code>t</code>, return <code>None</code>. Assume that the labels of <code>t</code> are unique.</p>

<p>First talk through how to make and use the recursive call.
(Try it yourselves; don't just click the hint button. That's how you learn.)</p>


        <button id='toggle-6' class='btn btn-outline btn-lg alwaystoggle toggle'>
        Hint: Describing the Recursive Call<noscript> (enable JavaScript)</noscript>
        </button>
        <div class="solution toggle-6">
<strong>What recursive calls will you make?</strong>

<p><code>find_path(b, x)</code> on each branch <code>b</code>.</p>

<p><strong>What type of values do they return?</strong></p>

<p>Each recursive call will either return <code>None</code> or a non-empty list of node labels.</p>

<p><strong>What do the possible return values mean?</strong></p>

<p>If <code>find_path(b, x)</code> returns <code>None</code>, then <code>x</code> does not appear in <code>b</code>. If
<code>find_path(b, x)</code> returns a list, then it contains the node labels for a path
through <code>b</code> that ends with the node labeled <code>x</code>.</p>

<p><strong>How can you use those return values to complete your implementation?</strong></p>

<p>If a list is returned, then it contains all of the labels in the path except
<code>label(t)</code>, which must be placed at the front.
</div></p>


            <div class="monaco-storable" id="find_path-input" style="height:432px;"></div>
            <a href="javascript:void" id="modal-link-find_path-input">Run in 61A Code</a>
            <div class="modal fade" id="modal-find_path-input" tabindex="-1" role="dialog">
                <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content" style="padding-bottom: -5px">
                    <iframe
                        id="code-iframe-find_path-input"
                        width="100%"
                        height="700px"
                        style="border: none; display:block;"
                    ></iframe>
                    </div>
                </div>
            </div>
            <div class="storable-status"></div>
            <script>
                $(() => activateEditor('def find_path(t, x):\n    &quot;&quot;&quot;\n    &gt;&gt;&gt; t2 = tree(5, [tree(6), tree(7)])\n    &gt;&gt;&gt; t1 = tree(3, [tree(4), t2])\n    &gt;&gt;&gt; find_path(t1, 5)\n    [3, 5]\n    &gt;&gt;&gt; find_path(t1, 4)\n    [3, 4]\n    &gt;&gt;&gt; find_path(t1, 6)\n    [3, 5, 6]\n    &gt;&gt;&gt; find_path(t2, 6)\n    [5, 6]\n    &gt;&gt;&gt; print(find_path(t1, 2))\n    None\n    &quot;&quot;&quot;\n    if ____:\n        return ____\n    ____:\n        path = ____\n        if path:\n            return ____\n    return None\n', "python", "find_path-input"));
            </script>
        



<p>Please don't view the hints until you've discussed with your group and can't make progress.</p>


        <button id='toggle-7' class='btn btn-outline btn-lg alwaystoggle toggle'>
        Hint: Base Case<noscript> (enable JavaScript)</noscript>
        </button>
        <div class="solution toggle-7">
If <code>x</code> is the label of <code>t</code>, then return a list with one element that contains the label of <code>t</code>.

</div>


        <button id='toggle-8' class='btn btn-outline btn-lg alwaystoggle toggle'>
        Hint: Recursive Case<noscript> (enable JavaScript)</noscript>
        </button>
        <div class="solution toggle-8"> Assign <code>path</code> to the result of a
recursive call to <code>find_path(b, x)</code> so that you can both check whether it's
<code>None</code> and extend it if it's a list.

<p>For a list <code>path</code> and a value <code>v</code>, the expression <code>[v] + path</code> creates a longer
list that starts with <code>v</code> and then has the elements of <code>path</code>.
</div></p>

<p><strong>Description Time!</strong> When your group has completed this question, it's time to
describe why this function does not have a base case that uses <code>is_leaf</code>. Come
up with an explanation as a group, pick someone to present your answer, and then
tell your TA (on <a href="https://berkeley.zoom.us/j/91340395124?pwd=7Lqljf1tslL0QlufLz6HrBtSCB8Ojv.1">Zoom</a> if your TA is remote).</p>

<div class="page-break"></div>


<h1 id="document-the-occasion">Document the Occasion</h1>


<p>For each person, the rest of the group should try to guess their <em>big word</em>
(from the Getting Started section). The group only gets one guess. After they
guess, reveal your <em>big word</em> and how many times you used it during discussion.</p>

<p>Please all fill out the <a href="https://forms.gle/UCYakosihNmKSuZE9">attendance form</a> (one submission per person per week).</p>
<script>
    $('.alwaystoggle').css('display', 'inline-block');
    $('.alwaystoggle').click(function() {
      var solution_id = $(this).attr('id');
      $('div.' + solution_id).slideToggle(600);
    });
</script>

  </div>

  <div class='col-md-3 sticky'>
    <nav class='hidden-print hidden-sm hidden-xs sidebar'>
      <ul>
  <li><a href="#getting-started">Getting Started</a></li>
  <li><a href="#trees">Trees</a></li>
  <ul>
    <li><a href="#q1-warm-up">Q1: Warm Up</a></li>
    <li><a href="#q2-has-path">Q2: Has Path</a></li>
    <li><a href="#q3-find-path">Q3: Find Path</a></li>
  </ul>
  <li><a href="#document-the-occasion">Document the Occasion</a></li>
</ul>
    </nav>
  </div>
</div>

    </main>

    <!-- <footer class="container">
      <div class="row text-center">
        <div class="col col-sm-4">
          <h3><a href="/">CS 61A</a></h3>
          <ul class="nav nav-pills nav-stacked">
            <li><a href="/weekly">Weekly Schedule</a></li>
            <li><a href="/office-hours">Office Hours</a></li>
            <li><a href="/staff">Staff</a></li>
          </ul>
        </div>
        <div class="col col-sm-4">
          <h3><a href="/resources">Resources</a></h3>
          <ul class="nav nav-pills nav-stacked">
            <li><a href="/articles/studying">Studying Guide</a></li>
            <li><a href="/articles/debugging">Debugging Guide</a></li>
            <li><a href="/articles/composition">Composition Guide</a></li>
            <li><a href="/articles/pair-programming">Pair Programming</a></li>
          </ul>
        </div>
        <div class="col col-sm-4">
          <h3><a href="/articles/about">Policies</a></h3>
          <ul class="nav nav-pills nav-stacked">
            <li><a href="/articles/about#assignments">Assignments</a></li>
            <li><a href="/articles/about#exams">Exams</a></li>
            <li><a href="/articles/about#grading">Grading</a></li>
          </ul>
        </div>
      </div>
    </footer> -->

    

    <script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.20.0/min/vs/loader.min.js"></script>
  <link rel="stylesheet" data-name="vs/editor/editor.main" href="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.20.0/min/vs/editor/editor.main.min.css">
  <script>
      require.config({ paths: { 'vs': 'https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.20.0/min/vs' }});
      window.MonacoEnvironment = { getWorkerUrl: () => URL.createObjectURL(new Blob([`
      self.MonacoEnvironment = {
          baseUrl: 'https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.20.0/min'
      };
      importScripts('https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.20.0/min/vs/base/worker/workerMain.min.js');
  `], { type: 'text/javascript' }))
  };
  </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jsPlumb/2.15.5/js/jsplumb.min.js"></script>
    <script src="/assets/js/network_storage.js"></script>
    <script src="/assets/js/code_tabindex.js"></script>
    <script src="/assets/js/storable.js"></script>
    <script src="/assets/js/editor.js"></script>
    <script src="/assets/js/copy-button.js"></script>
    <script src="/assets/js/env-diagram.js"></script>
    
<!-- <script src="/assets/js/sketchy.js"></script> -->
<script>
  $('.sidebar ul').addClass('nav nav-stacked noselect');
  $('body').scrollspy({
    target: '.sidebar',
    offset: 40
  });

  function goToId(id) {
    var target = $(id);
    target.parent().show();
    $('html,body').animate({
      scrollTop: target.offset().top,
    }, 100);
    $("body").scrollspy('refresh');
  }

  if (location.hash) {
    setTimeout(function() {
      if (location.hash) {
        goToId(location.hash);
      }
    }, 1);
  }

  $("a").click(function(event) {
    var urlBeforeHashRegEx = new RegExp("^"+window.location.href.split("#")[0]);
    if (/^#/.test(this.hash) && urlBeforeHashRegEx.test(this.href)) {
      event.preventDefault();
      goToId(this.hash);
      document.location.hash = this.hash;
    }
  });
</script>

  </body>
</html>